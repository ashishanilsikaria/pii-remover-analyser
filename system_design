title PII Remover & Analyser - System Design Flow
direction TB
// Step 1: Application & File Upload
Start [shape: oval, color: lightblue, icon: play]
Streamlit UI [color: lightgreen, icon: layout] {
  File Upload Widget [icon: upload, color: green]
  Multi-format Support [icon: files, color: green]
}

// Step 2: Content Extraction & Processing
Content Extraction [color: yellow, icon: file-text] {
  Image Processing [icon: image, color: lightyellow]
  Excel/DataFrame [icon: grid, color: lightyellow]
  PPTX Content [icon: presentation, color: lightyellow]
  PDF Parsing [icon: file, color: lightyellow]
}

// Step 3: PII Detection & Removal
PII Processing [color: red, icon: shield] {
  Presidio Analyzer [icon: search, color: lightcoral]
  Custom Patterns [icon: target, color: lightcoral]
  Anonymization [icon: lock, color: lightcoral]
}

// Step 4: AI Analysis & Insights
AI Analysis [color: purple, icon: brain] {
  Gemini Integration [icon: zap, color: mediumpurple]
  Security Assessment [icon: shield, color: mediumpurple]
  Key Findings [icon: lightbulb, color: mediumpurple]
}

// Step 5: Output & Reporting
Output Generation [color: darkgreen, icon: bar-chart] {
  Results Display [icon: monitor, color: lightgreen]
  PowerPoint Reports [icon: presentation, color: lightgreen]
  Download Options [icon: download, color: lightgreen]
}

// End State
End [shape: oval, color: lightgreen, icon: check-circle]

// Main Flow Connections
Start > Streamlit UI
File Upload Widget > Content Extraction: Process uploaded files
Multi-format Support > Content Extraction: Route by file type

Image Processing > PII Processing
Excel/DataFrame > PII Processing
PPTX Content > PII Processing
PDF Parsing > PII Processing

Presidio Analyzer > Anonymization
Custom Patterns > Anonymization
Anonymization > AI Analysis

Gemini Integration > Security Assessment
Security Assessment > Key Findings
Key Findings > Output Generation

Results Display > End
PowerPoint Reports > End
Download Options > End

// Batch Processing Loop
End > File Upload Widget: Process next file